<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<meta content="User Manual of Nuitka with the details on how to use it" name="description" />
<meta content="python,compiler,nuitka,manual" name="keywords" />
    <link rel="icon" href="../_static/favicon.svg" type="image/svg+xml">
    <link rel="icon" href="../_static/favicon.png" sizes="32x32" type="image/png">
    <link rel="icon" href="../_static/favicon.ico" sizes="32x32" type="image/x-icon">
    <link rel="icon" href="../_static/apple-touch-icon-iphone.png" sizes="57x57" type="image/png">
    <link rel="icon" href="../_static/apple-touch-icon-ipad.png" sizes="72x72" type="image/png">
    <link rel="icon" href="../_static/apple-touch-icon-iphone4.png" sizes="114x114" type="image/png">
    <link rel="icon" href="../_static/apple-touch-icon-ipad3.png" sizes="144x144" type="image/png">
    <link rel="apple-touch-icon" href="../_static/apple-touch-icon-180x180.png" sizes="180x180" type="image/png">

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Nuitka User Manual</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/my_theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/design-style.59c74d8c95b765a7fd995ac71d459ebe.min.css" type="text/css" />
    <link rel="canonical" href="https://nuitka.net/doc/user-manual.html" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script src="../_static/design-tabs.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Support" href="../pages/support.html" />
    <link rel="prev" title="Nuitka Downloads" href="download.html" />   
<link
  rel="alternate"
  type="application/atom+xml"
  href="../blog/atom.xml"
  title="Nuitka Blog"
/>
 
<style type="text/css">
  ul.ablog-archive {
    list-style: none;
    overflow: auto;
    margin-left: 0px;
  }
  ul.ablog-archive li {
    float: left;
    margin-right: 5px;
    font-size: 80%;
  }
  ul.postlist a {
    font-style: italic;
  }
  ul.postlist-style-disc {
    list-style-type: disc;
  }
  ul.postlist-style-none {
    list-style-type: none;
  }
  ul.postlist-style-circle {
    list-style-type: circle;
  }
</style>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Nuitka the Python Compiler
            <img src="../_static/Nuitka-Logo-Symbol.svg" class="logo" alt="Logo"/>
          </a><!-- Empty override file take the place of searchbox.html, which generates search box. -->
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="download.html">Download</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">User Manual</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#usage">Usage</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#command-line">Command Line</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#license">License</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#tutorial-setup-and-build-on-windows">Tutorial Setup and build on Windows</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#setup">Setup</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#install-python">Install Python</a></li>
<li class="toctree-l4"><a class="reference internal" href="#install-nuitka">Install Nuitka</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#write-some-code-and-test">Write some code and test</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#create-a-folder-for-the-python-code">Create a folder for the Python code</a></li>
<li class="toctree-l4"><a class="reference internal" href="#test-your-program">Test your program</a></li>
<li class="toctree-l4"><a class="reference internal" href="#build-it-using">Build it using</a></li>
<li class="toctree-l4"><a class="reference internal" href="#run-it">Run it</a></li>
<li class="toctree-l4"><a class="reference internal" href="#distribute">Distribute</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#use-cases">Use Cases</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#use-case-1-program-compilation-with-all-modules-embedded">Use Case 1 - Program compilation with all modules embedded</a></li>
<li class="toctree-l3"><a class="reference internal" href="#use-case-2-extension-module-compilation">Use Case 2 - Extension Module compilation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#use-case-3-package-compilation">Use Case 3 - Package compilation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#use-case-4-program-distribution">Use Case 4 - Program Distribution</a></li>
<li class="toctree-l3"><a class="reference internal" href="#use-case-5-setuptools-wheels">Use Case 5 - Setuptools Wheels</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#tweaks">Tweaks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#icons">Icons</a></li>
<li class="toctree-l3"><a class="reference internal" href="#splash-screen">Splash screen</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#typical-problems">Typical Problems</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#memory-issues-and-compiler-bugs">Memory issues and compiler bugs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ask-nuitka-to-use-less-memory">Ask Nuitka to use less memory</a></li>
<li class="toctree-l4"><a class="reference internal" href="#avoid-32-bit-c-compiler-assembler-memory-limits">Avoid 32 bit C compiler/assembler memory limits</a></li>
<li class="toctree-l4"><a class="reference internal" href="#use-lto-compilation-or-not">Use LTO compilation or not</a></li>
<li class="toctree-l4"><a class="reference internal" href="#switch-the-c-compiler-to-clang">Switch the C compiler to clang</a></li>
<li class="toctree-l4"><a class="reference internal" href="#add-a-larger-swap-file-to-your-embedded-linux">Add a larger swap file to your embedded Linux</a></li>
<li class="toctree-l4"><a class="reference internal" href="#limit-the-amount-of-compilation-jobs">Limit the amount of compilation jobs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#dynamic-sys-path">Dynamic <code class="docutils literal notranslate"><span class="pre">sys.path</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#missing-data-files-in-standalone">Missing data files in standalone</a></li>
<li class="toctree-l3"><a class="reference internal" href="#missing-dlls-in-standalone">Missing DLLs in standalone</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dependency-creep-in-standalone">Dependency creep in standalone</a></li>
<li class="toctree-l3"><a class="reference internal" href="#onefile-finding-files">Onefile: Finding files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#windows-programs-without-console-give-no-errors">Windows Programs without console give no errors</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#tips">Tips</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#nuitka-options-in-the-code">Nuitka Options in the code</a></li>
<li class="toctree-l3"><a class="reference internal" href="#python-command-line-flags">Python command line flags</a></li>
<li class="toctree-l3"><a class="reference internal" href="#caching-compilation-results">Caching compilation results</a></li>
<li class="toctree-l3"><a class="reference internal" href="#control-where-caches-live">Control where Caches live</a></li>
<li class="toctree-l3"><a class="reference internal" href="#runners">Runners</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastest-c-compilers">Fastest C Compilers</a></li>
<li class="toctree-l3"><a class="reference internal" href="#unexpected-slowdowns">Unexpected Slowdowns</a></li>
<li class="toctree-l3"><a class="reference internal" href="#standalone-executables-and-dependencies">Standalone executables and dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="#windows-errors-with-resources">Windows errors with resources</a></li>
<li class="toctree-l3"><a class="reference internal" href="#windows-standalone-program-redistribuation">Windows standalone program redistribuation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#detecting-nuitka-at-run-time">Detecting Nuitka at run time</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#performance">Performance</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pystone-results">pystone results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#where-to-go-next">Where to go next</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#follow-me-on-twitter">Follow me on Twitter</a></li>
<li class="toctree-l3"><a class="reference internal" href="#report-issues-or-bugs">Report issues or bugs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#word-of-warning">Word of Warning</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#join-nuitka">Join Nuitka</a></li>
<li class="toctree-l2"><a class="reference internal" href="#donations">Donations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#unsupported-functionality">Unsupported functionality</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-co-code-attribute-of-code-objects">The <code class="docutils literal notranslate"><span class="pre">co_code</span></code> attribute of code objects</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pdb">PDB</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#optimization">Optimization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#constant-folding">Constant Folding</a></li>
<li class="toctree-l3"><a class="reference internal" href="#constant-propagation">Constant Propagation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#built-in-name-lookups">Built-in Name Lookups</a></li>
<li class="toctree-l3"><a class="reference internal" href="#built-in-call-prediction">Built-in Call Prediction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#conditional-statement-prediction">Conditional Statement Prediction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#exception-propagation">Exception Propagation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#exception-scope-reduction">Exception Scope Reduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#exception-block-inlining">Exception Block Inlining</a></li>
<li class="toctree-l3"><a class="reference internal" href="#empty-branch-removal">Empty Branch Removal</a></li>
<li class="toctree-l3"><a class="reference internal" href="#unpacking-prediction">Unpacking Prediction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#built-in-type-inference">Built-in Type Inference</a></li>
<li class="toctree-l3"><a class="reference internal" href="#quicker-function-calls">Quicker Function Calls</a></li>
<li class="toctree-l3"><a class="reference internal" href="#lowering-of-iterated-container-types">Lowering of iterated Container Types</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#updates-for-this-manual">Updates for this Manual</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../pages/support.html">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../switcher.html">Switcher</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Commercial Users</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="commercial.html">Nuitka Commercial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Release Information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Changelog.html">Nuitka Release 0.6.20 (Draft)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog.html#nuitka-release-0-6-19">Nuitka Release 0.6.19</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog.html#nuitka-release-0-6-18">Nuitka Release 0.6.18</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog.html#older-releases">Older Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="roadmap.html">Roadmap</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">More documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="developer-manual.html">Developer Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="api-doc.html">API doc</a></li>
<li class="toctree-l1"><a class="reference internal" href="factory.html">Factory Instructions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Media</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../pages/Presentations.html">Presentations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/Streaming.html">Streaming</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Credits.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/impressum.html">Impressum</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Under construction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="welcome.html">Welcome</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/pyside2.html">Nuitka PySide2 support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/donations.html">Donations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/gsoc2019.html">Google Summer of Code 2019</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Nuitka the Python Compiler</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <!-- Empty override file take the place of sphinx_rtd_theme/breadcrumbs.html, which generates the top nav breadcrumbs. -->
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
              <section id="nuitka-user-manual">
<h1>Nuitka User Manual<a class="headerlink" href="#nuitka-user-manual" title="Permalink to this headline"></a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline"></a></h2>
<p>This document is the recommended first read if you are interested in
using Nuitka, understand its use cases, check what you can expect,
license, requirements, credits, etc.</p>
<p>Nuitka is <strong>the</strong> Python compiler. It is written in Python. It is a
seamless replacement or extension to the Python interpreter and compiles
<strong>every</strong> construct that CPython 2.6, 2.7, 3.3, 3.4, 3.5, 3.6, 3.7, 3.8,
3.9, 3.10 have, when itself run with that Python version.</p>
<p>It then executes uncompiled code and compiled code together in an
extremely compatible manner.</p>
<p>You can use all Python library modules and all extension modules freely.</p>
<p>Nuitka translates the Python modules into a C level program that then
uses <code class="docutils literal notranslate"><span class="pre">libpython</span></code> and static C files of its own to execute in the same
way as CPython does.</p>
<p>All optimization is aimed at avoiding overhead, where it’s unnecessary.
None is aimed at removing compatibility, although slight improvements
will occasionally be done, where not every bug of standard Python is
emulated, e.g. more complete error messages are given, but there is a
full compatibility mode to disable even that.</p>
</section>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline"></a></h2>
<section id="requirements">
<h3>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline"></a></h3>
<ul>
<li><p>C Compiler: You need a compiler with support for C11 or alternatively
for C++03 <a class="footnote-reference brackets" href="#id3" id="id1">1</a></p>
<p>Currently this means, you need to use one of these compilers:</p>
<ul class="simple">
<li><p>The MinGW64 C11 compiler on Windows, must be based on gcc 11.2 or
higher. It will be <em>automatically</em> downloaded if no usable C
compiler is found, which is the recommended way of installing it,
as Nuitka will also upgrade it for you.</p></li>
<li><p>Visual Studio 2022 or higher on Windows <a class="footnote-reference brackets" href="#id4" id="id2">2</a>, older versions will
work but only supported for commercial users. Configure to use the
English language pack for best results (Nuitka filters away
garbage outputs, but only for English language). It will be used
by default if installed.</p></li>
<li><p>On all other platforms, the <code class="docutils literal notranslate"><span class="pre">gcc</span></code> compiler of at least version
5.1, and below that the <code class="docutils literal notranslate"><span class="pre">g++</span></code> compiler of at least version 4.4
as an alternative.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">clang</span></code> compiler on macOS X and most FreeBSD architectures.</p></li>
<li><p>On Windows the <code class="docutils literal notranslate"><span class="pre">clang-cl</span></code> compiler on Windows can be used if
provided by the Visual Studio installer.</p></li>
</ul>
</li>
<li><p>Python: Version 2.6, 2.7 or 3.3, 3.4, 3.5, 3.6, 3.7, 3.8, 3.9, 3.10</p>
<div class="admonition-for-python-3-3-3-4-and-only-those-we-need-other-python-version-as-a-compile-time-dependency admonition">
<p class="admonition-title">For Python 3.3/3.4 and <em>only</em> those, we need other Python version as a <em>compile time</em> dependency.</p>
<p>Nuitka itself is fully compatible with all listed versions, but
Scons as an internally used tool is not.</p>
<p>For these versions, you <em>need</em> a Python2 or Python 3.5 or higher
installed as well, but only during the compile time only. That is
for use with Scons (which orchestrates the C compilation), which
does not support the same Python versions as Nuitka.</p>
<p>In addition, on Windows, Python2 cannot be used because
<code class="docutils literal notranslate"><span class="pre">clcache</span></code> does not work with it, there a Python 3.5 or higher
needs to be installed.</p>
<p>Nuitka finds these needed Python versions (on Windows via
registry) and you shouldn’t notice it as long as they are
installed.</p>
</div>
<div class="admonition-moving-binaries-to-other-machines admonition">
<p class="admonition-title">Moving binaries to other machines</p>
<p>The created binaries can be made executable independent of the
Python installation, with <code class="docutils literal notranslate"><span class="pre">--standalone</span></code> and <code class="docutils literal notranslate"><span class="pre">--onefile</span></code>
options.</p>
</div>
<div class="admonition-binary-filename-suffix admonition">
<p class="admonition-title">Binary filename suffix</p>
<p>The created binaries have an <code class="docutils literal notranslate"><span class="pre">.exe</span></code> suffix on Windows. On other
platforms they have no suffix for standalone mode, or <code class="docutils literal notranslate"><span class="pre">.bin</span></code>
suffix, that you are free to remove or change, or specify with the
<code class="docutils literal notranslate"><span class="pre">-o</span></code> option.</p>
<p>The suffix for acceleration mode is added just to be sure that the
original script name and the binary name do not ever collide, so
we can safely do an overwrite without destroying the original
source file.</p>
</div>
<div class="admonition-it-has-to-be-cpython-anaconda-python admonition">
<p class="admonition-title">It <strong>has to</strong> be CPython, Anaconda Python.</p>
<p>You need the standard Python implementation, called “CPython”, to
execute Nuitka, because it is closely tied to implementation
details of it.</p>
</div>
<div class="admonition-it-cannot-be-from-windows-app-store admonition">
<p class="admonition-title">It <strong>cannot be</strong> from Windows app store</p>
<p>It is known that Windows app store Python definitely does not
work, it’s checked against. And on macOS “pyenv” likely does
<strong>not</strong> work.</p>
</div>
</li>
<li><p>Operating System: Linux, FreeBSD, NetBSD, macOS X, and Windows (32/64
bits).</p>
<p>Others may work as well. The portability is expected to be generally
good, but the e.g. Scons usage may have to be adapted. Make sure to
match Windows Python and C compiler architecture, or else you will
get cryptic error messages.</p>
</li>
<li><p>Architectures: x86, x86_64 (amd64), and arm, likely many more</p>
<p>Other architectures are expected to also work, out of the box, as
Nuitka is generally not using any hardware specifics. These are just
the ones tested and known to be good. Feedback is welcome. Generally,
the architectures that Debian supports can be considered good and
tested too.</p>
</li>
</ul>
<dl class="footnote brackets">
<dt class="label" id="id3"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Support for this C11 is a given with gcc 5.x or higher or any clang
version.</p>
<p>The MSVC compiler doesn’t do it yet. But as a workaround, as the C++03
language standard is very overlapping with C11, it is then used instead
where the C compiler is too old. Nuitka used to require a C++ compiler
in the past, but it changed.</p>
</dd>
<dt class="label" id="id4"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>Download for free from
<a class="reference external" href="https://www.visualstudio.com/en-us/downloads/download-visual-studio-vs.aspx">https://www.visualstudio.com/en-us/downloads/download-visual-studio-vs.aspx</a>
(the community editions work just fine).</p>
<p>The latest version is recommended but not required. On the other hand,
there is no need to except pre-Windows 10 support, and they might work
for you, but support of these configurations is only available to
commercial users.</p>
</dd>
</dl>
</section>
<section id="command-line">
<h3>Command Line<a class="headerlink" href="#command-line" title="Permalink to this headline"></a></h3>
<p>The recommended way of executing Nuitka is <code class="docutils literal notranslate"><span class="pre">&lt;the_right_python&gt;</span> <span class="pre">-m</span>
<span class="pre">nuitka</span></code> to be absolutely certain which Python interpreter you are
using, so it is easier to match with what Nuitka has.</p>
<p>The next best way of executing Nuitka bare that is from a source
checkout or archive, with no environment variable changes, most
noteworthy, you do not have to mess with <code class="docutils literal notranslate"><span class="pre">PYTHONPATH</span></code> at all for
Nuitka. You just execute the <code class="docutils literal notranslate"><span class="pre">nuitka</span></code> and <code class="docutils literal notranslate"><span class="pre">nuitka-run</span></code> scripts
directly without any changes to the environment. You may want to add the
<code class="docutils literal notranslate"><span class="pre">bin</span></code> directory to your <code class="docutils literal notranslate"><span class="pre">PATH</span></code> for your convenience, but that step
is optional.</p>
<p>Moreover, if you want to execute with the right interpreter, in that
case, be sure to execute <code class="docutils literal notranslate"><span class="pre">&lt;the_right_python&gt;</span> <span class="pre">bin/nuitka</span></code> and be good.</p>
<div class="admonition-pick-the-right-interpreter admonition">
<p class="admonition-title">Pick the right Interpreter</p>
<p>If you encounter a <code class="docutils literal notranslate"><span class="pre">SyntaxError</span></code> you absolutely most certainly have
picked the wrong interpreter for the program you are compiling.</p>
</div>
<p>Nuitka has a <code class="docutils literal notranslate"><span class="pre">--help</span></code> option to output what it can do:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>nuitka --help
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">nuitka-run</span></code> command is the same as <code class="docutils literal notranslate"><span class="pre">nuitka</span></code>, but with a
different default. It tries to compile <em>and</em> directly execute a Python
script:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>nuitka-run --help
</pre></div>
</div>
<p>This option that is different is <code class="docutils literal notranslate"><span class="pre">--run</span></code>, and passing on arguments
after the first non-option to the created binary, so it is somewhat more
similar to what plain <code class="docutils literal notranslate"><span class="pre">python</span></code> will do.</p>
</section>
<section id="installation">
<h3>Installation<a class="headerlink" href="#installation" title="Permalink to this headline"></a></h3>
<p>For most systems, there will be packages on the <a class="reference external" href="https://nuitka.net/doc/download.html">download page</a> of Nuitka. But you can also
install it from source code as described above, but also like any other
Python program it can be installed via the normal <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">setup.py</span>
<span class="pre">install</span></code> routine.</p>
</section>
<section id="license">
<h3>License<a class="headerlink" href="#license" title="Permalink to this headline"></a></h3>
<p>Nuitka is licensed under the Apache License, Version 2.0; you may not
use it except in compliance with the License.</p>
<p>You may obtain a copy of the License at
<a class="reference external" href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a></p>
<p>Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an “AS IS” BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.</p>
</section>
</section>
<section id="tutorial-setup-and-build-on-windows">
<h2>Tutorial Setup and build on Windows<a class="headerlink" href="#tutorial-setup-and-build-on-windows" title="Permalink to this headline"></a></h2>
<p>This is basic steps if you have nothing installed, of course if you have
any of the parts, just skip it.</p>
<section id="setup">
<h3>Setup<a class="headerlink" href="#setup" title="Permalink to this headline"></a></h3>
<section id="install-python">
<h4>Install Python<a class="headerlink" href="#install-python" title="Permalink to this headline"></a></h4>
<ul class="simple">
<li><p>Download and install from <a class="reference external" href="https://www.python.org/downloads/windows">https://www.python.org/downloads/windows</a></p></li>
<li><p>Select one of <code class="docutils literal notranslate"><span class="pre">Windows</span> <span class="pre">x86-64</span> <span class="pre">web-based</span> <span class="pre">installer</span></code> (64 bits Python,
recommended) or <code class="docutils literal notranslate"><span class="pre">x86</span> <span class="pre">executable</span></code> (32 bits Python) installer.</p></li>
<li><p>Verify using command <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">--version</span></code>.</p></li>
</ul>
</section>
<section id="install-nuitka">
<h4>Install Nuitka<a class="headerlink" href="#install-nuitka" title="Permalink to this headline"></a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">pip</span> <span class="pre">install</span> <span class="pre">nuitka</span></code></p></li>
<li><p>Verify using command <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">nuitka</span> <span class="pre">--version</span></code></p></li>
</ul>
</section>
</section>
<section id="write-some-code-and-test">
<h3>Write some code and test<a class="headerlink" href="#write-some-code-and-test" title="Permalink to this headline"></a></h3>
<section id="create-a-folder-for-the-python-code">
<h4>Create a folder for the Python code<a class="headerlink" href="#create-a-folder-for-the-python-code" title="Permalink to this headline"></a></h4>
<ul class="simple">
<li><p>mkdir HelloWorld</p></li>
<li><p>make a python file named <strong>hello.py</strong></p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">talk</span><span class="p">(</span><span class="n">message</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&quot;Talk &quot;</span> <span class="o">+</span> <span class="n">message</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">talk</span><span class="p">(</span><span class="s2">&quot;Hello World&quot;</span><span class="p">))</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="test-your-program">
<h4>Test your program<a class="headerlink" href="#test-your-program" title="Permalink to this headline"></a></h4>
<p>Do as you normally would. Running Nuitka on code that works incorrectly
is not easier to debug.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python hello.py
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="build-it-using">
<h4>Build it using<a class="headerlink" href="#build-it-using" title="Permalink to this headline"></a></h4>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python -m nuitka hello.py
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This will prompt you to download a C caching tool (to speed up
repeated compilation of generated C code) and a MinGW64 based C
compiler unless you have a suitable MSVC installed. Say <code class="docutils literal notranslate"><span class="pre">yes</span></code> to
both those questions.</p>
</div>
</section>
<section id="run-it">
<h4>Run it<a class="headerlink" href="#run-it" title="Permalink to this headline"></a></h4>
<p>Execute the <code class="docutils literal notranslate"><span class="pre">hello.exe</span></code> created near <code class="docutils literal notranslate"><span class="pre">hello.py</span></code>.</p>
</section>
<section id="distribute">
<h4>Distribute<a class="headerlink" href="#distribute" title="Permalink to this headline"></a></h4>
<p>To distribute, build with <code class="docutils literal notranslate"><span class="pre">--standalone</span></code> option, which will not output
a single executable, but a whole folder. Copy the resulting
<code class="docutils literal notranslate"><span class="pre">hello.dist</span></code> folder to the other machine and run it.</p>
<p>You may also try <code class="docutils literal notranslate"><span class="pre">--onefile</span></code> which does create a single file, but make
sure that the mere standalone is working, before turning to it, as it
will make the debugging only harder, e.g. in case of missing data files.</p>
</section>
</section>
</section>
<section id="use-cases">
<h2>Use Cases<a class="headerlink" href="#use-cases" title="Permalink to this headline"></a></h2>
<section id="use-case-1-program-compilation-with-all-modules-embedded">
<h3>Use Case 1 - Program compilation with all modules embedded<a class="headerlink" href="#use-case-1-program-compilation-with-all-modules-embedded" title="Permalink to this headline"></a></h3>
<p>If you want to compile a whole program recursively, and not only the
single file that is the main program, do it like this:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python -m nuitka --follow-imports program.py
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There are more fine grained controls than <code class="docutils literal notranslate"><span class="pre">--follow-imports</span></code>
available. Consider the output of <code class="docutils literal notranslate"><span class="pre">nuitka</span> <span class="pre">--help</span></code>. Including less
modules into the compilation, but instead using normal Python for it
will make it faster to compile.</p>
</div>
<p>In case you have a source directory with dynamically loaded files, i.e.
one which cannot be found by recursing after normal import statements
via the <code class="docutils literal notranslate"><span class="pre">PYTHONPATH</span></code> (which would be the recommended way), you can
always require that a given directory shall also be included in the
executable:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python -m nuitka --follow-imports --include-plugin-directory<span class="o">=</span>plugin_dir program.py
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you don’t do any dynamic imports, simply setting your
<code class="docutils literal notranslate"><span class="pre">PYTHONPATH</span></code> at compilation time is what you should do.</p>
<p>Use <code class="docutils literal notranslate"><span class="pre">--include-plugin-directory</span></code> only if you make <code class="docutils literal notranslate"><span class="pre">__import__()</span></code>
calls that Nuitka cannot predict, because they e.g. depend on command
line parameters. Nuitka also warns about these, and point to the
option.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The resulting filename will be <code class="docutils literal notranslate"><span class="pre">program.exe</span></code> on Windows,
<code class="docutils literal notranslate"><span class="pre">program.bin</span></code> on other platforms.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The resulting binary still depend on CPython and used C extension
modules being installed.</p>
<p>If you want to be able to copy it to another machine, use
<code class="docutils literal notranslate"><span class="pre">--standalone</span></code> and copy the created <code class="docutils literal notranslate"><span class="pre">program.dist</span></code> directory and
execute the <code class="docutils literal notranslate"><span class="pre">program.exe</span></code> (Windows) or <code class="docutils literal notranslate"><span class="pre">program</span></code> (other
platforms) put inside.</p>
</div>
</section>
<section id="use-case-2-extension-module-compilation">
<h3>Use Case 2 - Extension Module compilation<a class="headerlink" href="#use-case-2-extension-module-compilation" title="Permalink to this headline"></a></h3>
<p>If you want to compile a single extension module, all you have to do is
this:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python -m nuitka --module some_module.py
</pre></div>
</div>
<p>The resulting file <code class="docutils literal notranslate"><span class="pre">some_module.so</span></code> can then be used instead of
<code class="docutils literal notranslate"><span class="pre">some_module.py</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It’s left as an exercise to the reader, to find out what happens if
both are present.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The option <code class="docutils literal notranslate"><span class="pre">--follow-imports</span></code> and other variants work as well, but
the included modules will only become importable <em>after</em> you imported
the <code class="docutils literal notranslate"><span class="pre">some_module</span></code> name.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The resulting extension module can only be loaded into a CPython of
the same version and doesn’t include other extension modules.</p>
</div>
</section>
<section id="use-case-3-package-compilation">
<h3>Use Case 3 - Package compilation<a class="headerlink" href="#use-case-3-package-compilation" title="Permalink to this headline"></a></h3>
<p>If you need to compile a whole package and embed all modules, that is
also feasible, use Nuitka like this:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python -m nuitka --module some_package --include-package<span class="o">=</span>some_package
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The inclusion of the package contents needs to be provided manually,
otherwise, the package is empty. You can be more specific if you
want, and only include part of it. Data files located inside the
package will not be embedded by this process, you need to copy them
yourself with this approach.</p>
</div>
</section>
<section id="use-case-4-program-distribution">
<h3>Use Case 4 - Program Distribution<a class="headerlink" href="#use-case-4-program-distribution" title="Permalink to this headline"></a></h3>
<p>For distribution to other systems, there is the standalone mode which
produces a folder for which you can specify <code class="docutils literal notranslate"><span class="pre">--standalone</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python -m nuitka --standalone program.py
</pre></div>
</div>
<p>Follow all imports is default in this mode. You can selectively exclude
modules by specifically saying <code class="docutils literal notranslate"><span class="pre">--nofollow-import-to</span></code>, but then an
<code class="docutils literal notranslate"><span class="pre">ImportError</span></code> will be raised when import of it is attempted at program
runtime.</p>
<p>For data files to be included, use the option
<code class="docutils literal notranslate"><span class="pre">--include-data-file=&lt;source&gt;=&lt;target&gt;</span></code> where the source is a file
system path, but target has to be specified relative. For standalone you
can also copy them manually, but this can do extra checks, and for
onefile mode, there is no manual copying possible.</p>
<p>To copy some or all file in a directory, use the option
<code class="docutils literal notranslate"><span class="pre">--include-data-file=/etc/*.txt=etc/</span></code> where you get to specify shell
patterns for the files, and a subdirectory where to put them, indicated
by the trailing slash.</p>
<p>To copy a whole folder with all files, you can use
<code class="docutils literal notranslate"><span class="pre">--include-data-dir=/path/to/images=images</span></code> which will copy all files
including a potential subdirectory structure. You cannot filter here,
i.e. if you want only a partial copy, remove the files beforehand.</p>
<p>For package data, there is a better way, using
<code class="docutils literal notranslate"><span class="pre">--include-package-data</span></code> which detects data files of packages
automatically and copies them over. It even accepts patterns in shell
style.</p>
<p>With data files, you are largely on your own. Nuitka keeps track of ones
that are needed by popular packages, but it might be incomplete. Raise
issues if you encounter something in these.</p>
<p>When that is working, you can use the onefile mode if you so desire.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python -m nuitka --onefile program.py
</pre></div>
</div>
<p>This will create a single binary, which on Linux will not even unpack
itself, but instead loop back mount its contents as a filesystem and use
that.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a binary that unpacks into a temporary folder</span>
python -m nuitka --onefile program.py
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There are more platform specific options, e.g. related to icons,
splash screen, and version information, consider the <code class="docutils literal notranslate"><span class="pre">--help</span></code>
output for the details of these and check the section “Good Looks”.</p>
</div>
<p>Again, on Windows, for the temporary file directory, by default the user
one is used, however this is overridable with a path specification given
in <code class="docutils literal notranslate"><span class="pre">--windows-onefile-tempdir-spec=%TEMP%\\onefile_%PID%_%TIME%</span></code> which
is the default and asserts that the temporary directories created cannot
collide.</p>
<p>Currently these expanded tokens are available:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 13%" />
<col style="width: 45%" />
<col style="width: 42%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Token</p></th>
<th class="head"><p>What this Expands to</p></th>
<th class="head"><p>Example</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>%TEMP%</p></td>
<td><p>User temporary file directory</p></td>
<td><p>C:Users...AppDataLocalsTemp</p></td>
</tr>
<tr class="row-odd"><td><p>%PID%</p></td>
<td><p>Process ID</p></td>
<td><p>2772</p></td>
</tr>
<tr class="row-even"><td><p>%TIME%</p></td>
<td><p>Time in seconds since the epoch.</p></td>
<td><p>1299852985</p></td>
</tr>
<tr class="row-odd"><td><p>%PROGRAM%</p></td>
<td><p>Full program filename of executable.</p></td>
<td><p>C:SomeWhereYourOnefile.exe</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is your responsibility to make the path provided unique, on
Windows a running program will be locked, and while using a fixed
folder name is possible, it can cause locking issues in that case,
where the program gets restarted.</p>
<p>Usually you need to use <code class="docutils literal notranslate"><span class="pre">%TIME%</span></code> or at least <code class="docutils literal notranslate"><span class="pre">%PID%</span></code> to make a
path unique, and this is mainly intended for use cases, where e.g.
you want things to reside in a place you choose or abide your naming
conventions.</p>
</div>
</section>
<section id="use-case-5-setuptools-wheels">
<h3>Use Case 5 - Setuptools Wheels<a class="headerlink" href="#use-case-5-setuptools-wheels" title="Permalink to this headline"></a></h3>
<p>If you have a <code class="docutils literal notranslate"><span class="pre">setup.py</span></code>, <code class="docutils literal notranslate"><span class="pre">setup.cfg</span></code> or <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> driven
creation of wheels for your software in place, putting Nuitka to use is
extremely easy.</p>
<p>Lets start with the most common <code class="docutils literal notranslate"><span class="pre">setuptools</span></code> approach, you can -
having Nuitka installed of course, simply execute the target
<code class="docutils literal notranslate"><span class="pre">bdist_nuitka</span></code> rather than the <code class="docutils literal notranslate"><span class="pre">bdist_wheel</span></code>. It takes all the
options and allows you to specify some more, that are specific to
Nuitka.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># For setup.py if not you&#39;t use other build systems:</span>
<span class="n">setup</span><span class="p">(</span>
   <span class="o">...</span><span class="p">,</span>
   <span class="n">command_options</span><span class="o">=</span><span class="p">{</span>
      <span class="s1">&#39;nuitka&#39;</span><span class="p">:</span> <span class="p">{</span>
         <span class="c1"># boolean option, e.g. if you cared for C commands</span>
         <span class="s1">&#39;--show-scons&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
         <span class="c1"># options without value, e.g. enforce using Clang</span>
         <span class="s1">&#39;--clang&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;setup.py&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
         <span class="c1"># options with single values, e.g. enable a plugin of Nuitka</span>
         <span class="s1">&#39;--enable-plugin&#39;</span><span class="p">:</span> <span class="s1">&#39;anti-bloat&#39;</span><span class="p">,</span>
         <span class="c1"># options with several values, e.g. avoiding including modules</span>
         <span class="s1">&#39;--nofollow-import-to&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;*.tests&quot;</span><span class="p">,</span> <span class="s2">&quot;*.distutils&quot;</span><span class="p">],</span>
      <span class="p">}</span>
   <span class="p">},</span>
<span class="p">)</span>

<span class="c1"># For setup.py with other build systems:</span>
<span class="c1"># The tuple nature of the arguments is required by the dark nature of</span>
<span class="c1"># &quot;setuptools&quot; and plugins to it, that insist on full compatibility,</span>
<span class="c1"># e.g. &quot;setuptools_rust&quot;</span>

<span class="n">setup</span><span class="p">(</span>
   <span class="o">...</span><span class="p">,</span>
   <span class="n">command_options</span><span class="o">=</span><span class="p">{</span>
      <span class="s1">&#39;nuitka&#39;</span><span class="p">:</span> <span class="p">{</span>
         <span class="c1"># boolean option, e.g. if you cared for C commands</span>
         <span class="s1">&#39;--show-scons&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;setup.py&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span>
         <span class="c1"># options without value, e.g. enforce using Clang</span>
         <span class="s1">&#39;--clang&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;setup.py&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
         <span class="c1"># options with single values, e.g. enable a plugin of Nuitka</span>
         <span class="s1">&#39;--enable-plugin&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;setup.py&quot;</span><span class="p">,</span> <span class="s1">&#39;anti-bloat&#39;</span><span class="p">),</span>
         <span class="c1"># options with several values, e.g. avoiding including modules</span>
         <span class="s1">&#39;--nofollow-import-to&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="s2">&quot;setup.py&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;*.tests&quot;</span><span class="p">,</span> <span class="s2">&quot;*.distutils&quot;</span><span class="p">]),</span>
      <span class="p">}</span>
   <span class="p">},</span>
<span class="p">)</span>
</pre></div>
</div>
<p>If for some reason, you cannot or do not what to change the target, you
can add this to your <code class="docutils literal notranslate"><span class="pre">setup.py</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># For setup.py</span>
<span class="n">setup</span><span class="p">(</span>
   <span class="o">...</span><span class="p">,</span>
   <span class="n">build_with_nuitka</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To temporarily disable the compilation, you could remove above line,
or edit the value to <code class="docutils literal notranslate"><span class="pre">False</span></code> by or take its value from an
environment variable if you so choose, e.g.
<code class="docutils literal notranslate"><span class="pre">bool(os.environ.get(&quot;USE_NUITKA&quot;,</span> <span class="pre">&quot;True&quot;))</span></code>. This is up to you.</p>
</div>
<p>Or you could put it in your <code class="docutils literal notranslate"><span class="pre">setup.cfg</span></code></p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[metadata]</span><span class="w"></span>
<span class="n">build_with_nuitka</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">True</span><span class="w"></span>
</pre></div>
</div>
<p>And last, but not least, Nuitka also supports the new <code class="docutils literal notranslate"><span class="pre">build</span></code> meta, so
when you have a <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> already, simple replace or add this
value:</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[build-system]</span><span class="w"></span>
<span class="n">requires</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;setuptools&gt;=42&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;wheel&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;nuitka&quot;</span><span class="p">]</span><span class="w"></span>
<span class="n">build-backend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;nuitka.distutils.Build&quot;</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>
<section id="tweaks">
<h2>Tweaks<a class="headerlink" href="#tweaks" title="Permalink to this headline"></a></h2>
<section id="icons">
<h3>Icons<a class="headerlink" href="#icons" title="Permalink to this headline"></a></h3>
<p>For good looks, you may specify icons. On Windows, you can provide an
icon file, a template executable, or a PNG file. All of these will work
and may even be combined:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># These create binaries with icons:</span>
python -m nuitka --onefile --windows-icon-from-ico<span class="o">=</span>your-icon.png program.py
python -m nuitka --onefile --windows-icon-from-ico<span class="o">=</span>your-icon.ico program.py
python -m nuitka --onefile --windows-icon-template-exe<span class="o">=</span>your-icon.ico program.py
</pre></div>
</div>
</section>
<section id="splash-screen">
<h3>Splash screen<a class="headerlink" href="#splash-screen" title="Permalink to this headline"></a></h3>
<p>Splash screens are useful when program startup is slow. Onefile startup
itself is not slow, but your program may be, and you cannot really know
how fast the computer used will be, so it might be a good idea to have
them. Luckily with Nuitka, they are easy to add for Windows.</p>
<p>For splash screen, you need to specify it as an PNG file, and then make
sure to disable the splash screen when your program is ready, e.g. has
complete the imports, prepared the window, connected to the database,
and wants the splash screen to go away. Here we are using the project
syntax to combine the code with the creation, compile this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># nuitka-project: --onefile</span>
<span class="c1"># nuitka-project: --onefile-windows-splash-screen-image={MAIN_DIRECTORY}/Splash-Screen.png</span>

<span class="c1"># Whatever this is obviously</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Delaying startup by 10s...&quot;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># Use this code to signal the splash screen removal.</span>
<span class="k">if</span> <span class="s2">&quot;NUITKA_ONEFILE_PARENT&quot;</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">:</span>
   <span class="n">splash_filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
      <span class="n">tempfile</span><span class="o">.</span><span class="n">gettempdir</span><span class="p">(),</span>
      <span class="s2">&quot;onefile_</span><span class="si">%d</span><span class="s2">_splash_feedback.tmp&quot;</span> <span class="o">%</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;NUITKA_ONEFILE_PARENT&quot;</span><span class="p">]),</span>
   <span class="p">)</span>

   <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">splash_filename</span><span class="p">):</span>
      <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">splash_filename</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Done... splash should be gone.&quot;</span><span class="p">)</span>
<span class="o">...</span>

<span class="c1"># Rest of your program goes here.</span>
</pre></div>
</div>
</section>
</section>
<section id="typical-problems">
<h2>Typical Problems<a class="headerlink" href="#typical-problems" title="Permalink to this headline"></a></h2>
<section id="memory-issues-and-compiler-bugs">
<h3>Memory issues and compiler bugs<a class="headerlink" href="#memory-issues-and-compiler-bugs" title="Permalink to this headline"></a></h3>
<p>Sometimes the C compilers will crash saying they cannot allocate memory
or that some input was truncated, or similar error messages, clearly
from it. There are several options you can explore here:</p>
<section id="ask-nuitka-to-use-less-memory">
<h4>Ask Nuitka to use less memory<a class="headerlink" href="#ask-nuitka-to-use-less-memory" title="Permalink to this headline"></a></h4>
<p>There is a dedicated option <code class="docutils literal notranslate"><span class="pre">--low-memory</span></code> which influces decisions of
Nuitka, such that it avoids high usage of memory during compilation at
the cost of increased compile time.</p>
</section>
<section id="avoid-32-bit-c-compiler-assembler-memory-limits">
<h4>Avoid 32 bit C compiler/assembler memory limits<a class="headerlink" href="#avoid-32-bit-c-compiler-assembler-memory-limits" title="Permalink to this headline"></a></h4>
<p>Do not use a 32 bits compiler, but a 64 bit one. If you are using Python
with 32 bits on Windows, you most definitely ought to use MSVC as the C
compiler, and not MinGW64. The MSVC is a cross compiler, and can use
more memory than gcc on that platform. If you are not on Windows, that
is not an option of course. Also using the 64 bits Python will work.</p>
</section>
<section id="use-lto-compilation-or-not">
<h4>Use LTO compilation or not<a class="headerlink" href="#use-lto-compilation-or-not" title="Permalink to this headline"></a></h4>
<p>With <code class="docutils literal notranslate"><span class="pre">--lto=yes</span></code> or <code class="docutils literal notranslate"><span class="pre">--lto=no</span></code> you can switch the C compilation to
only produce bytecode, and not assembler code and machine code directly,
but make a whole program optimization at the end. This will change the
memory usage pretty dramatically, and if you error is coming from the
assembler, using LTO will most definitely avoid that.</p>
</section>
<section id="switch-the-c-compiler-to-clang">
<h4>Switch the C compiler to clang<a class="headerlink" href="#switch-the-c-compiler-to-clang" title="Permalink to this headline"></a></h4>
<p>People have reported that programs that fail to compile with gcc due to
its bugs or memory usage work fine with clang on Linux. On Windows, this
could still be an option, but it needs to be implemented first for the
automatic downloaded gcc, that would contain it. Since MSVC is known to
be more memory effective anyway, you should go there, and if you want to
use Clang, there is support for the one contained in MSVC.</p>
</section>
<section id="add-a-larger-swap-file-to-your-embedded-linux">
<h4>Add a larger swap file to your embedded Linux<a class="headerlink" href="#add-a-larger-swap-file-to-your-embedded-linux" title="Permalink to this headline"></a></h4>
<p>On systems with not enough RAM, you need to use swap space. Running out
of it is possibly a cause, and adding more swap space, or one at all,
might solve the issue, but beware that it will make things extremely
slow when the compilers swap back and forth, so consider the next tip
first or on top of it.</p>
</section>
<section id="limit-the-amount-of-compilation-jobs">
<h4>Limit the amount of compilation jobs<a class="headerlink" href="#limit-the-amount-of-compilation-jobs" title="Permalink to this headline"></a></h4>
<p>With the <code class="docutils literal notranslate"><span class="pre">--jobs</span></code> option of Nuitka, it will not start many C compiler
instances at once, each competing for the scarce resource of RAM. By
picking a value of one, only one C compiler instance will be running,
and on a 8 core system, that reduces the amount of memory by factor 8,
so that’s a natural choice right there.</p>
</section>
</section>
<section id="dynamic-sys-path">
<h3>Dynamic <code class="docutils literal notranslate"><span class="pre">sys.path</span></code><a class="headerlink" href="#dynamic-sys-path" title="Permalink to this headline"></a></h3>
<p>If your script modifies <code class="docutils literal notranslate"><span class="pre">sys.path</span></code> to e.g. insert directories with
source code relative to it, Nuitka will currently not be able to see
those. However, if you set the <code class="docutils literal notranslate"><span class="pre">PYTHONPATH</span></code> to the resulting value,
you will be able to compile it.</p>
</section>
<section id="missing-data-files-in-standalone">
<h3>Missing data files in standalone<a class="headerlink" href="#missing-data-files-in-standalone" title="Permalink to this headline"></a></h3>
<p>If your program fails to file data, it can cause all kinds of different
behaviours, e.g. a package might complain it is not the right version,
because a <code class="docutils literal notranslate"><span class="pre">VERSION</span></code> file check defaulted to unknown. The absence of
icon files or help texts, may raise strange errors.</p>
<p>Often the error paths for files not being present are even buggy and
will reveal programming errors like unbound local variables. Please look
carefully at these exceptions keeping in mind that this can be the
cause. If you program works without standalone, chances are data files
might be cause.</p>
</section>
<section id="missing-dlls-in-standalone">
<h3>Missing DLLs in standalone<a class="headerlink" href="#missing-dlls-in-standalone" title="Permalink to this headline"></a></h3>
<p>Nuitka has plugins that deal with copying DLLs. For NumPy, SciPy,
Tkinter, etc.</p>
<p>These need special treatment to be able to run on other systems.
Manually copying them is not enough and will given strange errors.
Sometimes newer version of packages, esp. NumPy can be unsupported. In
this case you will have to raise an issue, and use the older one.</p>
</section>
<section id="dependency-creep-in-standalone">
<h3>Dependency creep in standalone<a class="headerlink" href="#dependency-creep-in-standalone" title="Permalink to this headline"></a></h3>
<p>Some packages are a single import, but to Nuitka mean that more than a
thousand packages (literally) are to be included. The prime example of
Pandas, which does want to plug and use just about everything you can
imagine. Multiple frameworks for syntax highlighting everything
imaginable take time.</p>
<p>Nuitka will have to learn effective caching to deal with this in the
future. Right now, you will have to deal with huge compilation times for
these.</p>
<p>For now, a major weapon in fighting dependency creap should be applied,
namely the <code class="docutils literal notranslate"><span class="pre">anti-bloat</span></code> plugin, which offers interesting abilities,
that can be put to use and block unneeded imports, giving an error for
where they occur. Use it e.g. like this <code class="docutils literal notranslate"><span class="pre">--enable-plugin=anti-bloat</span>
<span class="pre">--noinclude-pytest-mode=nofollow</span> <span class="pre">--noinclude-setuptools-mode=nofollow</span></code>
and check its help output. It can take for each module of your choice,
e.g. forcing also that PyQt5 is considered uninstalled for standalone
mode.</p>
</section>
<section id="onefile-finding-files">
<h3>Onefile: Finding files<a class="headerlink" href="#onefile-finding-files" title="Permalink to this headline"></a></h3>
<p>There is a difference between <code class="docutils literal notranslate"><span class="pre">sys.argv[0]</span></code> and <code class="docutils literal notranslate"><span class="pre">__file__</span></code> of the
main module for onefile more, that is caused by using a bootstrap to a
temporary location. The first one will be the original executable path,
where as the second one will be the temporary or permanent path the
bootstrap executable unpacks to. Data files will be in the later
location, your original environment files will be in the former
location.</p>
<p>Given 2 files, one which you expect to be near your executable, and one
which you expect to be inside the onefile binary, access them like this.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># This will find a file near your onefile.exe</span>
<span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s2">&quot;user-provided-file.txt&quot;</span><span class="p">))</span>
<span class="c1"># This will find a file inside your onefile.exe</span>
<span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s2">&quot;user-provided-file.txt&quot;</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="windows-programs-without-console-give-no-errors">
<h3>Windows Programs without console give no errors<a class="headerlink" href="#windows-programs-without-console-give-no-errors" title="Permalink to this headline"></a></h3>
<p>For debugging purposes, remove <code class="docutils literal notranslate"><span class="pre">--windows-disable-console</span></code> or use the
options <code class="docutils literal notranslate"><span class="pre">--windows-force-stdout-spec</span></code> and
<code class="docutils literal notranslate"><span class="pre">--windows-force-stderr-spec</span></code> with paths as documented for
<code class="docutils literal notranslate"><span class="pre">--windows-onefile-tempdir-spec</span></code> above.</p>
</section>
</section>
<section id="tips">
<h2>Tips<a class="headerlink" href="#tips" title="Permalink to this headline"></a></h2>
<section id="nuitka-options-in-the-code">
<h3>Nuitka Options in the code<a class="headerlink" href="#nuitka-options-in-the-code" title="Permalink to this headline"></a></h3>
<p>There is support for conditional options, and options using pre-defined
variables, this is an example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compilation mode, support OS specific.</span>
<span class="c1"># nuitka-project-if: {OS} in (&quot;Windows&quot;, &quot;Linux&quot;, &quot;Darwin&quot;, &quot;FreeBSD&quot;):</span>
<span class="c1">#    nuitka-project: --onefile</span>
<span class="c1"># nuitka-project-if: {OS} not in (&quot;Windows&quot;, &quot;Linux&quot;, &quot;Darwin&quot;, &quot;FreeBSD&quot;):</span>
<span class="c1">#    nuitka-project: --standalone</span>

<span class="c1"># The PySide2 plugin covers qt-plugins</span>
<span class="c1"># nuitka-project: --enable-plugin=pyside2</span>
<span class="c1"># nuitka-project: --include-qt-plugins=sensible,qml</span>
</pre></div>
</div>
<p>The comments must be a start of line, and indentation is to be used, to
end a conditional block, much like in Python. There are currently no
other keywords than the used ones demonstrated above.</p>
<p>You can put abitrary Python expressions there, and if you wanted to e.g.
access a version information of a package, you could simply use
<code class="docutils literal notranslate"><span class="pre">__import__(&quot;module_name&quot;).__version__</span></code> if that would be required to
e.g. enable or disable certain Nuitka settings. The only thing Nuitka
does that makes this not Python expressions, is expanding <code class="docutils literal notranslate"><span class="pre">{variable}</span></code>
for a pre-defined set of variables:</p>
<p>Table with supported variables:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 35%" />
<col style="width: 46%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Variable</p></th>
<th class="head"><p>What this Expands to</p></th>
<th class="head"><p>Example</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>{OS}</p></td>
<td><p>Name of the OS used</p></td>
<td><p>Linux, Windows, Darwin, FreeBSD, OpenBSD</p></td>
</tr>
<tr class="row-odd"><td><p>{Version}</p></td>
<td><p>Version of Nuitka</p></td>
<td><p>e.g. (0, 6, 16)</p></td>
</tr>
<tr class="row-even"><td><p>{Commercial}</p></td>
<td><p>Version of Nuitka Commercial</p></td>
<td><p>e.g. (0, 9, 4)</p></td>
</tr>
<tr class="row-odd"><td><p>{Arch}</p></td>
<td><p>Architecture used</p></td>
<td><p>x86_64, arm64, etc.</p></td>
</tr>
<tr class="row-even"><td><p>{MAIN_DIRECTORY}</p></td>
<td><p>Directory of the compiled file</p></td>
<td><p>some_dir/maybe_relative</p></td>
</tr>
<tr class="row-odd"><td><p>{Flavor}</p></td>
<td><p>Variant of Python</p></td>
<td><p>e.g. Debian Python, Anaconda Python</p></td>
</tr>
</tbody>
</table>
</section>
<section id="python-command-line-flags">
<h3>Python command line flags<a class="headerlink" href="#python-command-line-flags" title="Permalink to this headline"></a></h3>
<p>For passing things like <code class="docutils literal notranslate"><span class="pre">-O</span></code> or <code class="docutils literal notranslate"><span class="pre">-S</span></code> to Python, to your compiled
program, there is a command line option name <code class="docutils literal notranslate"><span class="pre">--python-flag=</span></code> which
makes Nuitka emulate these options.</p>
<p>The most important ones are supported, more can certainly be added.</p>
</section>
<section id="caching-compilation-results">
<h3>Caching compilation results<a class="headerlink" href="#caching-compilation-results" title="Permalink to this headline"></a></h3>
<p>The C compiler, when invoked with the same input files, will take a long
time and much CPU to compile over and over. Make sure you are having
<code class="docutils literal notranslate"><span class="pre">ccache</span></code> installed and configured when using gcc (even on Windows). It
will make repeated compilations much faster, even if things are not yet
not perfect, i.e. changes to the program can cause many C files to
change, requiring a new compilation instead of using the cached result.</p>
<p>On Windows, with gcc Nuitka supports using <code class="docutils literal notranslate"><span class="pre">ccache.exe</span></code> which it will
offer to download from an official source and it automatically. This is
the recommended way of using it on Windows, as other versions can e.g.
hang.</p>
<p>Nuitka will pick up <code class="docutils literal notranslate"><span class="pre">ccache</span></code> if it’s in found in system <code class="docutils literal notranslate"><span class="pre">PATH</span></code>, and
it will also be possible to provide if by setting
<code class="docutils literal notranslate"><span class="pre">NUITKA_CCACHE_BINARY</span></code> to the full path of the binary, this is for use
in CI systems.</p>
<p>For the MSVC compilers and ClangCL setups, using the <code class="docutils literal notranslate"><span class="pre">clcache</span></code> is
automatic and included in Nuitka.</p>
</section>
<section id="control-where-caches-live">
<h3>Control where Caches live<a class="headerlink" href="#control-where-caches-live" title="Permalink to this headline"></a></h3>
<p>The storage for cache results of all kinds, downloads, cached
compilation results from C and Nuitka, is done in a platform dependent
directory as determined by the <code class="docutils literal notranslate"><span class="pre">appdirs</span></code> package. However, you can
override it with setting the environment variable <code class="docutils literal notranslate"><span class="pre">NUITKA_CACHE_DIR</span></code>
to a base directory. This is for use in environments where the home
directory is not persisted, but other paths are.</p>
</section>
<section id="runners">
<h3>Runners<a class="headerlink" href="#runners" title="Permalink to this headline"></a></h3>
<p>Avoid running the <code class="docutils literal notranslate"><span class="pre">nuitka</span></code> binary, doing <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">nuitka</span></code> will
make a 100% sure you are using what you think you are. Using the wrong
Python will make it give you <code class="docutils literal notranslate"><span class="pre">SyntaxError</span></code> for good code or
<code class="docutils literal notranslate"><span class="pre">ImportError</span></code> for installed modules. That is happening, when you run
Nuitka with Python2 on Python3 code and vice versa. By explicitly
calling the same Python interpreter binary, you avoid that issue
entirely.</p>
</section>
<section id="fastest-c-compilers">
<h3>Fastest C Compilers<a class="headerlink" href="#fastest-c-compilers" title="Permalink to this headline"></a></h3>
<p>The fastest binaries of <code class="docutils literal notranslate"><span class="pre">pystone.exe</span></code> on Windows with 64 bits Python
proved to be significantly faster with MinGW64, roughly 20% better
score. So it is recommended for use over MSVC. Using <code class="docutils literal notranslate"><span class="pre">clang-cl.exe</span></code> of
Clang7 was faster than MSVC, but still significantly slower than
MinGW64, and it will be harder to use, so it is not recommended.</p>
<p>On Linux for <code class="docutils literal notranslate"><span class="pre">pystone.bin</span></code> the binary produced by <code class="docutils literal notranslate"><span class="pre">clang6</span></code> was
faster than <code class="docutils literal notranslate"><span class="pre">gcc-6.3</span></code>, but not by a significant margin. Since gcc is
more often already installed, that is recommended to use for now.</p>
<p>Differences in C compilation times have not yet been examined.</p>
</section>
<section id="unexpected-slowdowns">
<h3>Unexpected Slowdowns<a class="headerlink" href="#unexpected-slowdowns" title="Permalink to this headline"></a></h3>
<p>Using the Python DLL, like standard CPython does can lead to unexpected
slowdowns, e.g. in uncompiled code that works with Unicode strings. This
is because calling to the DLL rather than residing in the DLL causes
overhead, and this even happens to the DLL with itself, being slower,
than a Python all contained in one binary.</p>
<p>So if feasible, aim at static linking, which is currently only possible
with Anaconda Python on non-Windows, Debian Python2, self compiled
Pythons (do not activate <code class="docutils literal notranslate"><span class="pre">--enable-shared</span></code>, not needed), and installs
created with <code class="docutils literal notranslate"><span class="pre">pyenv</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>On Anaconda, you may need to execute <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">install</span> <span class="pre">-c</span> <span class="pre">conda-forge</span>
<span class="pre">libpython-static</span></code></p>
</div>
</section>
<section id="standalone-executables-and-dependencies">
<h3>Standalone executables and dependencies<a class="headerlink" href="#standalone-executables-and-dependencies" title="Permalink to this headline"></a></h3>
<p>The process of making standalone executables for Windows traditionally
involves using an external dependency walker in order to copy necessary
libraries along with the compiled executables to the distribution
folder.</p>
<p>There is plenty of ways to find that something is missing. Do not
manually copy things into the folder, esp. not DLLs, as that’s not going
to work. Instead make bug reports to get these handled by Nuitka
properly.</p>
</section>
<section id="windows-errors-with-resources">
<h3>Windows errors with resources<a class="headerlink" href="#windows-errors-with-resources" title="Permalink to this headline"></a></h3>
<p>On Windows, the Windows Defender tool and the Windows Indexing Service
both scan the freshly created binaries, while Nuitka wants to work with
it, e.g. adding more resources, and then preventing operations randomly
due to holding locks. Make sure to exclude your compilation stage from
these services.</p>
</section>
<section id="windows-standalone-program-redistribuation">
<h3>Windows standalone program redistribuation<a class="headerlink" href="#windows-standalone-program-redistribuation" title="Permalink to this headline"></a></h3>
<p>Whether compiling with MingW or MSVC, the standalone programs have
external dependencies to Visual C Runtime libraries. Nuitka tries to
ship those dependent DLLs by copying them from your system.</p>
<p>Beginning with Microsoft Windows 10, Microsoft ships <code class="docutils literal notranslate"><span class="pre">ucrt.dll</span></code>
(Universal C Runtime libraries) which rehook calls to
<code class="docutils literal notranslate"><span class="pre">api-ms-crt-*.dll</span></code>.</p>
<p>With earlier Windows platforms (and wine/ReactOS), you should consider
installing Visual C Runtime libraries before executing a Nuitka
standalone compiled program.</p>
<p>Depending on the used C compiler, you’ll need the following redist
versions:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 29%" />
<col style="width: 21%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Visual C version</p></th>
<th class="head"><p>Redist Year</p></th>
<th class="head"><p>CPython</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>14.2</p></td>
<td><p>2019</p></td>
<td><p>3.5, 3.6, 3.7, 3.8, 3.9, 3.10</p></td>
</tr>
<tr class="row-odd"><td><p>14.1</p></td>
<td><p>2017</p></td>
<td><p>3.5, 3.6, 3.7, 3.8</p></td>
</tr>
<tr class="row-even"><td><p>14.0</p></td>
<td><p>2015</p></td>
<td><p>3.5, 3.6, 3.7, 3.8</p></td>
</tr>
<tr class="row-odd"><td><p>10.0</p></td>
<td><p>2010</p></td>
<td><p>3.3, 3.4</p></td>
</tr>
<tr class="row-even"><td><p>9.0</p></td>
<td><p>2008</p></td>
<td><p>2.6, 2.7</p></td>
</tr>
</tbody>
</table>
<p>When using MingGW64, you’ll need the following redist versions:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 29%" />
<col style="width: 21%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>MingGW64 version</p></th>
<th class="head"><p>Redist Year</p></th>
<th class="head"><p>CPython</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>8.1.0</p></td>
<td><p>2015</p></td>
<td><p>3.5, 3.6, 3.7, 3.8, 3.9, 3.10</p></td>
</tr>
</tbody>
</table>
<p>Once the corresponding runtime libraries are installed on the target
system, you may remove all <code class="docutils literal notranslate"><span class="pre">api-ms-crt-*.dll</span></code> files from your Nuitka
compiled dist folder.</p>
</section>
<section id="detecting-nuitka-at-run-time">
<h3>Detecting Nuitka at run time<a class="headerlink" href="#detecting-nuitka-at-run-time" title="Permalink to this headline"></a></h3>
<p>It doesn’t set <code class="docutils literal notranslate"><span class="pre">sys.frozen</span></code> unlike other tools. For Nuitka, we have
the module attribute <code class="docutils literal notranslate"><span class="pre">__compiled__</span></code> to test if a specific module was
compiled.</p>
</section>
</section>
<section id="performance">
<h2>Performance<a class="headerlink" href="#performance" title="Permalink to this headline"></a></h2>
<p>This chapter gives an overview, of what to currently expect in terms of
performance from Nuitka. It’s a work in progress and is updated as we
go. The current focus for performance measurements is Python 2.7, but
3.x is going to follow later.</p>
<section id="pystone-results">
<h3>pystone results<a class="headerlink" href="#pystone-results" title="Permalink to this headline"></a></h3>
<p>The results are the top value from this kind of output, running pystone
1000 times and taking the minimal value. The idea is that the fastest
run is most meanigful, and eliminates usage spikes.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">echo</span> <span class="s2">&quot;Uncompiled Python2&quot;</span>
<span class="k">for</span> i <span class="k">in</span> <span class="o">{</span><span class="m">1</span>..100<span class="o">}</span><span class="p">;</span> <span class="k">do</span> <span class="nv">BENCH</span><span class="o">=</span><span class="m">1</span> python2 tests/benchmarks/pystone.py <span class="p">;</span> <span class="k">done</span> <span class="p">|</span> sort -n -r <span class="p">|</span> head -n <span class="m">1</span>
python2 -m nuitka --lto<span class="o">=</span>yes --pgo<span class="o">=</span>yes tests/benchmarks/pystone.py
<span class="nb">echo</span> <span class="s2">&quot;Compiled Python2&quot;</span>
<span class="k">for</span> i <span class="k">in</span> <span class="o">{</span><span class="m">1</span>..100<span class="o">}</span><span class="p">;</span> <span class="k">do</span> <span class="nv">BENCH</span><span class="o">=</span><span class="m">1</span> ./pystone.bin <span class="p">;</span> <span class="k">done</span> <span class="p">|</span> sort -n -r <span class="p">|</span> head -n <span class="m">1</span>

<span class="nb">echo</span> <span class="s2">&quot;Uncompiled Python3&quot;</span>
<span class="k">for</span> i <span class="k">in</span> <span class="o">{</span><span class="m">1</span>..100<span class="o">}</span><span class="p">;</span> <span class="k">do</span> <span class="nv">BENCH</span><span class="o">=</span><span class="m">1</span> python3 tests/benchmarks/pystone3.py <span class="p">;</span> <span class="k">done</span> <span class="p">|</span> sort -n -r <span class="p">|</span> head -n <span class="m">1</span>
python3 -m nuitka --lto<span class="o">=</span>yes --pgo<span class="o">=</span>yes tests/benchmarks/pystone3.py
<span class="nb">echo</span> <span class="s2">&quot;Compiled Python3&quot;</span>
<span class="k">for</span> i <span class="k">in</span> <span class="o">{</span><span class="m">1</span>..100<span class="o">}</span><span class="p">;</span> <span class="k">do</span> <span class="nv">BENCH</span><span class="o">=</span><span class="m">1</span> ./pystone3.bin <span class="p">;</span> <span class="k">done</span> <span class="p">|</span> sort -n -r <span class="p">|</span> head -n <span class="m">1</span>
</pre></div>
</div>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 23%" />
<col style="width: 27%" />
<col style="width: 26%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Python</p></th>
<th class="head"><p>Uncompiled</p></th>
<th class="head"><p>Compiled LTO</p></th>
<th class="head"><p>Compiled PGO</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Debian Python 2.7</p></td>
<td><p>137497.87 (1.000)</p></td>
<td><p>460995.20 (3.353)</p></td>
<td><p>503681.91 (3.663)</p></td>
</tr>
<tr class="row-odd"><td><p>Nuitka Python 2.7</p></td>
<td><p>144074.78 (1.048)</p></td>
<td><p>479271.51 (3.486)</p></td>
<td><p>511247.44 (3.718)</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="where-to-go-next">
<h2>Where to go next<a class="headerlink" href="#where-to-go-next" title="Permalink to this headline"></a></h2>
<p>Remember, this project is not completed yet. Although the CPython test
suite works near perfect, there is still more work needed, esp. to make
it do more optimization. Try it out.</p>
<section id="follow-me-on-twitter">
<h3>Follow me on Twitter<a class="headerlink" href="#follow-me-on-twitter" title="Permalink to this headline"></a></h3>
<p>Nuitka announcements and interesting stuff is pointed to on the Twitter
account, but obviously with not too many details. <a class="reference external" href="https://twitter.com/KayHayen">&#64;KayHayen</a>.</p>
</section>
<section id="report-issues-or-bugs">
<h3>Report issues or bugs<a class="headerlink" href="#report-issues-or-bugs" title="Permalink to this headline"></a></h3>
<p>Should you encounter any issues, bugs, or ideas, please visit the
<a class="reference external" href="https://github.com/kayhayen/Nuitka/issues">Nuitka bug tracker</a> and
report them.</p>
<p>Best practices for reporting bugs:</p>
<ul>
<li><p>Please always include the following information in your report, for
the underlying Python version. You can easily copy&amp;paste this into
your report.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python -m nuitka --version
</pre></div>
</div>
</li>
<li><p>Try to make your example minimal. That is, try to remove code that
does not contribute to the issue as much as possible. Ideally come up
with a small reproducing program that illustrates the issue, using
<code class="docutils literal notranslate"><span class="pre">print</span></code> with different results when that programs runs compiled or
native.</p></li>
<li><p>If the problem occurs spuriously (i.e. not each time), try to set the
environment variable <code class="docutils literal notranslate"><span class="pre">PYTHONHASHSEED</span></code> to <code class="docutils literal notranslate"><span class="pre">0</span></code>, disabling hash
randomization. If that makes the problem go away, try increasing in
steps of 1 to a hash seed value that makes it happen every time,
include it in your report.</p></li>
<li><p>Do not include the created code in your report. Given proper input,
it’s redundant, and it’s not likely that I will look at it without
the ability to change the Python or Nuitka source and re-run it.</p></li>
<li><p>Do not send screenshots of text, that is bad and lazy. Instead,
capture text outputs from the console.</p></li>
</ul>
</section>
<section id="word-of-warning">
<h3>Word of Warning<a class="headerlink" href="#word-of-warning" title="Permalink to this headline"></a></h3>
<p>Consider using this software with caution. Even though many tests are
applied before releases, things are potentially breaking. Your feedback
and patches to Nuitka are very welcome.</p>
</section>
</section>
<section id="join-nuitka">
<h2>Join Nuitka<a class="headerlink" href="#join-nuitka" title="Permalink to this headline"></a></h2>
<p>You are more than welcome to join Nuitka development and help to
complete the project in all minor and major ways.</p>
<p>The development of Nuitka occurs in git. We currently have these 3
branches:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">main</span></code></p>
<p>This branch contains the stable release to which only hotfixes for
bugs will be done. It is supposed to work at all times and is
supported.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">develop</span></code></p>
<p>This branch contains the ongoing development. It may at times contain
little regressions, but also new features. On this branch, the
integration work is done, whereas new features might be developed on
feature branches.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">factory</span></code></p>
<p>This branch contains unfinished and incomplete work. It is very
frequently subject to <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">rebase</span></code> and the public staging ground,
where my work for develop branch lives first. It is intended for
testing only and recommended to base any of your own development on.
When updating it, you very often will get merge conflicts. Simply
resolve those by doing <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">reset</span> <span class="pre">--hard</span> <span class="pre">origin/factory</span></code> and switch
to the latest version.</p>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <a class="reference external" href="https://nuitka.net/doc/developer-manual.html">Developer Manual</a> explains the coding
rules, branching model used, with feature branches and hotfix
releases, the Nuitka design and much more. Consider reading it to
become a contributor. This document is intended for Nuitka users.</p>
</div>
</section>
<section id="donations">
<h2>Donations<a class="headerlink" href="#donations" title="Permalink to this headline"></a></h2>
<p>Should you feel that you cannot help Nuitka directly, but still want to
support, please consider <a class="reference external" href="https://nuitka.net/pages/donations.html">making a donation</a> and help this way.</p>
</section>
<section id="unsupported-functionality">
<h2>Unsupported functionality<a class="headerlink" href="#unsupported-functionality" title="Permalink to this headline"></a></h2>
<section id="the-co-code-attribute-of-code-objects">
<h3>The <code class="docutils literal notranslate"><span class="pre">co_code</span></code> attribute of code objects<a class="headerlink" href="#the-co-code-attribute-of-code-objects" title="Permalink to this headline"></a></h3>
<p>The code objects are empty for native compiled functions. There is no
bytecode with Nuitka’s compiled function objects, so there is no way to
provide it.</p>
</section>
<section id="pdb">
<h3>PDB<a class="headerlink" href="#pdb" title="Permalink to this headline"></a></h3>
<p>There is no tracing of compiled functions to attach a debugger to.</p>
</section>
</section>
<section id="optimization">
<h2>Optimization<a class="headerlink" href="#optimization" title="Permalink to this headline"></a></h2>
<section id="constant-folding">
<h3>Constant Folding<a class="headerlink" href="#constant-folding" title="Permalink to this headline"></a></h3>
<p>The most important form of optimization is the constant folding. This is
when an operation can be fully predicted at compile time. Currently,
Nuitka does these for some built-ins (but not all yet, somebody to look
at this more closely will be very welcome!), and it does it e.g. for
binary/unary operations and comparisons.</p>
<p>Constants currently recognized:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="mi">5</span> <span class="o">+</span> <span class="mi">6</span>  <span class="c1"># binary operations</span>
<span class="ow">not</span> <span class="mi">7</span>  <span class="c1"># unary operations</span>
<span class="mi">5</span> <span class="o">&lt;</span> <span class="mi">6</span>  <span class="c1"># comparisons</span>
<span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># built-ins</span>
</pre></div>
</div>
<p>Literals are the one obvious source of constants, but also most likely
other optimization steps like constant propagation or function inlining
will be. So this one should not be underestimated and a very important
step of successful optimizations. Every option to produce a constant may
impact the generated code quality a lot.</p>
<div class="admonition-status admonition">
<p class="admonition-title">Status</p>
<p>The folding of constants is considered implemented, but it might be
incomplete in that not all possible cases are caught. Please report
it as a bug when you find an operation in Nuitka that has only
constants as input and is not folded.</p>
</div>
</section>
<section id="constant-propagation">
<h3>Constant Propagation<a class="headerlink" href="#constant-propagation" title="Permalink to this headline"></a></h3>
<p>At the core of optimizations, there is an attempt to determine the
values of variables at run time and predictions of assignments. It
determines if their inputs are constants or of similar values. An
expression, e.g. a module variable access, an expensive operation, may
be constant across the module of the function scope and then there needs
to be none or no repeated module variable look-up.</p>
<p>Consider e.g. the module attribute <code class="docutils literal notranslate"><span class="pre">__name__</span></code> which likely is only
ever read, so its value could be predicted to a constant string known at
compile time. This can then be used as input to the constant folding.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="c1"># Your test code might be here</span>
    <span class="n">use_something_not_use_by_program</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition-status admonition">
<p class="admonition-title">Status</p>
<p>From modules attributes, only <code class="docutils literal notranslate"><span class="pre">__name__</span></code> is currently actually
optimized. Also possible would be at least <code class="docutils literal notranslate"><span class="pre">__doc__</span></code>. In the
future, this may improve as SSA is expanded to module variables.</p>
</div>
</section>
<section id="built-in-name-lookups">
<h3>Built-in Name Lookups<a class="headerlink" href="#built-in-name-lookups" title="Permalink to this headline"></a></h3>
<p>Also, built-in exception name references are optimized if they are used
as a module level read-only variables:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">something</span><span class="p">()</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>  <span class="c1"># The ValueError is a slow global name lookup normally.</span>
    <span class="k">pass</span>
</pre></div>
</div>
<div class="admonition-status admonition">
<p class="admonition-title">Status</p>
<p>This works for all built-in names. When an assignment is done to such
a name, or it’s even local, then, of course, it is not done.</p>
</div>
</section>
<section id="built-in-call-prediction">
<h3>Built-in Call Prediction<a class="headerlink" href="#built-in-call-prediction" title="Permalink to this headline"></a></h3>
<p>For built-in calls like <code class="docutils literal notranslate"><span class="pre">type</span></code>, <code class="docutils literal notranslate"><span class="pre">len</span></code>, or <code class="docutils literal notranslate"><span class="pre">range</span></code> it is often
possible to predict the result at compile time, esp. for constant inputs
the resulting value often can be precomputed by Nuitka. It can simply
determine the result or the raised exception and replace the built-in
call with that value, allowing for more constant folding or code path
reduction.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="s2">&quot;string&quot;</span><span class="p">)</span>  <span class="c1"># predictable result, builtin type str.</span>
<span class="nb">len</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>  <span class="c1"># predictable result</span>
<span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># predictable result</span>
<span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># predictable exception, range raises due to 0.</span>
</pre></div>
</div>
<div class="admonition-status admonition">
<p class="admonition-title">Status</p>
<p>The built-in call prediction is considered implemented. We can simply
during compile time emulate the call and use its result or raised
exception. But we may not cover all the built-ins there are yet.</p>
</div>
<p>Sometimes the result of a built-in should not be predicted when the
result is big. A <code class="docutils literal notranslate"><span class="pre">range()</span></code> call e.g. may give too big values to
include the result in the binary. Then it is not done.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">range</span><span class="p">(</span><span class="mi">100000</span><span class="p">)</span>  <span class="c1"># We do not want this one to be expanded</span>
</pre></div>
</div>
<div class="admonition-status admonition">
<p class="admonition-title">Status</p>
<p>This is considered mostly implemented. Please file bugs for built-ins
that are pre-computed, but should not be computed by Nuitka at
compile time with specific values.</p>
</div>
</section>
<section id="conditional-statement-prediction">
<h3>Conditional Statement Prediction<a class="headerlink" href="#conditional-statement-prediction" title="Permalink to this headline"></a></h3>
<p>For conditional statements, some branches may not ever be taken, because
of the conditions being possible to predict. In these cases, the branch
not taken and the condition check is removed.</p>
<p>This can typically predict code like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="c1"># Your test code might be here</span>
    <span class="n">use_something_not_use_by_program</span><span class="p">()</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="kc">False</span><span class="p">:</span>
    <span class="c1"># Your deactivated code might be here</span>
    <span class="n">use_something_not_use_by_program</span><span class="p">()</span>
</pre></div>
</div>
<p>It will also benefit from constant propagations, or enable them because
once some branches have been removed, other things may become more
predictable, so this can trigger other optimization to become possible.</p>
<p>Every branch removed makes optimization more likely. With some code
branches removed, access patterns may be more friendly. Imagine e.g.
that a function is only called in a removed branch. It may be possible
to remove it entirely, and that may have other consequences too.</p>
<div class="admonition-status admonition">
<p class="admonition-title">Status</p>
<p>This is considered implemented, but for the maximum benefit, more
constants need to be determined at compile time.</p>
</div>
</section>
<section id="exception-propagation">
<h3>Exception Propagation<a class="headerlink" href="#exception-propagation" title="Permalink to this headline"></a></h3>
<p>For exceptions that are determined at compile time, there is an
expression that will simply do raise the exception. These can be
propagated upwards, collecting potentially “side effects”, i.e. parts of
expressions that were executed before it occurred, and still have to be
executed.</p>
<p>Consider the following code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">side_effect_having</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">0</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">something_else</span><span class="p">())</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">(1</span> <span class="pre">/</span> <span class="pre">0)</span></code> can be predicted to raise a <code class="docutils literal notranslate"><span class="pre">ZeroDivisionError</span></code>
exception, which will be propagated through the <code class="docutils literal notranslate"><span class="pre">+</span></code> operation. That
part is just Constant Propagation as normal.</p>
<p>The call <code class="docutils literal notranslate"><span class="pre">side_effect_having()</span></code> will have to be retained though, but
the <code class="docutils literal notranslate"><span class="pre">print</span></code> does not and can be turned into an explicit raise. The
statement sequence can then be aborted and as such the
<code class="docutils literal notranslate"><span class="pre">something_else</span></code> call needs no code generation or consideration
anymore.</p>
<p>To that end, Nuitka works with a special node that raises an exception
and is wrapped with a so-called “side_effects” expression, but yet can
be used in the code as an expression having a value.</p>
<div class="admonition-status admonition">
<p class="admonition-title">Status</p>
<p>The propagation of exceptions is mostly implemented but needs
handling in every kind of operations, and not all of them might do it
already. As work progresses or examples arise, the coverage will be
extended. Feel free to generate bug reports with non-working
examples.</p>
</div>
</section>
<section id="exception-scope-reduction">
<h3>Exception Scope Reduction<a class="headerlink" href="#exception-scope-reduction" title="Permalink to this headline"></a></h3>
<p>Consider the following code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">b</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Will not be executed&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">try</span></code> block is bigger than it needs to be. The statement <code class="docutils literal notranslate"><span class="pre">b</span> <span class="pre">=</span> <span class="pre">8</span></code>
cannot cause a <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> to be raised. As such it can be moved to
outside the try without any risk.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="mi">8</span>
<span class="k">try</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Will not be executed&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition-status admonition">
<p class="admonition-title">Status</p>
<p>This is considered done. For every kind of operation, we trace if it
may raise an exception. We do however <em>not</em> track properly yet, what
can do a <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> and what cannot.</p>
</div>
</section>
<section id="exception-block-inlining">
<h3>Exception Block Inlining<a class="headerlink" href="#exception-block-inlining" title="Permalink to this headline"></a></h3>
<p>With the exception propagation, it then becomes possible to transform
this code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">b</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Will not be executed!&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;range() step argument must not be zero&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
<p>Which then can be lowered in complexity by avoiding the raise and catch
of the exception, making it:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">e</span> <span class="o">=</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;range() step argument must not be zero&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition-status admonition">
<p class="admonition-title">Status</p>
<p>This is not implemented yet.</p>
</div>
</section>
<section id="empty-branch-removal">
<h3>Empty Branch Removal<a class="headerlink" href="#empty-branch-removal" title="Permalink to this headline"></a></h3>
<p>For loops and conditional statements that contain only code without
effect, it should be possible to remove the whole construct:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p>The loop could be removed, at maximum, it should be considered an
assignment of variable <code class="docutils literal notranslate"><span class="pre">i</span></code> to <code class="docutils literal notranslate"><span class="pre">999</span></code> and no more.</p>
<div class="admonition-status admonition">
<p class="admonition-title">Status</p>
<p>This is not implemented yet, as it requires us to track iterators,
and their side effects, as well as loop values, and exit conditions.
Too much yet, but we will get there.</p>
</div>
<p>Another example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">side_effect_free</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p>The condition check should be removed in this case, as its evaluation is
not needed. It may be difficult to predict that <code class="docutils literal notranslate"><span class="pre">side_effect_free</span></code> has
no side effects, but many times this might be possible.</p>
<div class="admonition-status admonition">
<p class="admonition-title">Status</p>
<p>This is considered implemented. The conditional statement nature is
removed if both branches are empty, only the condition is evaluated
and checked for truth (in cases that could raise an exception).</p>
</div>
</section>
<section id="unpacking-prediction">
<h3>Unpacking Prediction<a class="headerlink" href="#unpacking-prediction" title="Permalink to this headline"></a></h3>
<p>When the length of the right-hand side of an assignment to a sequence
can be predicted, the unpacking can be replaced with multiple
assignments.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">side_effect_free</span><span class="p">(),</span> <span class="mi">3</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">side_effect_free</span><span class="p">()</span>
<span class="n">c</span> <span class="o">=</span> <span class="mi">3</span>
</pre></div>
</div>
<p>This is of course only really safe if the left-hand side cannot raise an
exception while building the assignment targets.</p>
<p>We do this now, but only for constants, because we currently have no
ability to predict if an expression can raise an exception or not.</p>
<div class="admonition-status admonition">
<p class="admonition-title">Status</p>
<p>Not implemented yet. Will need us to see through the unpacking of
what is an iteration over a tuple, we created ourselves. We are not
there yet, but we will get there.</p>
</div>
</section>
<section id="built-in-type-inference">
<h3>Built-in Type Inference<a class="headerlink" href="#built-in-type-inference" title="Permalink to this headline"></a></h3>
<p>When a construct like <code class="docutils literal notranslate"><span class="pre">in</span> <span class="pre">xrange()</span></code> or <code class="docutils literal notranslate"><span class="pre">in</span> <span class="pre">range()</span></code> is used, it is
possible to know what the iteration does and represent that so that
iterator users can use that instead.</p>
<p>I consider that:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="n">something</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
<p>could translate <code class="docutils literal notranslate"><span class="pre">xrange(1000)</span></code> into an object of a special class that
does the integer looping more efficiently. In case <code class="docutils literal notranslate"><span class="pre">i</span></code> is only
assigned from there, this could be a nice case for a dedicated class.</p>
<div class="admonition-status admonition">
<p class="admonition-title">Status</p>
<p>Future work, not even started.</p>
</div>
</section>
<section id="quicker-function-calls">
<h3>Quicker Function Calls<a class="headerlink" href="#quicker-function-calls" title="Permalink to this headline"></a></h3>
<p>Functions are structured so that their parameter parsing and <code class="docutils literal notranslate"><span class="pre">tp_call</span></code>
interface is separate from the actual function code. This way the call
can be optimized away. One problem is that the evaluation order can
differ.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span>


<span class="n">f</span><span class="p">(</span><span class="n">c</span><span class="o">=</span><span class="n">get1</span><span class="p">(),</span> <span class="n">b</span><span class="o">=</span><span class="n">get2</span><span class="p">(),</span> <span class="n">a</span><span class="o">=</span><span class="n">get3</span><span class="p">())</span>
</pre></div>
</div>
<p>This will have to evaluate first <code class="docutils literal notranslate"><span class="pre">get1()</span></code>, then <code class="docutils literal notranslate"><span class="pre">get2()</span></code> and only
then <code class="docutils literal notranslate"><span class="pre">get3()</span></code> and then make the function call with these values.</p>
<p>Therefore it will be necessary to have a staging of the parameters
before making the actual call, to avoid a re-ordering of the calls to
<code class="docutils literal notranslate"><span class="pre">get1()</span></code>, <code class="docutils literal notranslate"><span class="pre">get2()</span></code>, and <code class="docutils literal notranslate"><span class="pre">get3()</span></code>.</p>
<div class="admonition-status admonition">
<p class="admonition-title">Status</p>
<p>Not even started. A re-formulation that avoids the dictionary to call
the function, and instead uses temporary variables appears to be
relatively straight forward once we do that kind of parameter
analysis.</p>
</div>
</section>
<section id="lowering-of-iterated-container-types">
<h3>Lowering of iterated Container Types<a class="headerlink" href="#lowering-of-iterated-container-types" title="Permalink to this headline"></a></h3>
<p>In some cases, accesses to <code class="docutils literal notranslate"><span class="pre">list</span></code> constants can become <code class="docutils literal notranslate"><span class="pre">tuple</span></code>
constants instead.</p>
<p>Consider that:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">]:</span>
    <span class="n">something</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>Can be optimized into this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
    <span class="n">something</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>This allows for simpler, faster code to be generated, and fewer checks
needed, because e.g. the <code class="docutils literal notranslate"><span class="pre">tuple</span></code> is clearly immutable, whereas the
<code class="docutils literal notranslate"><span class="pre">list</span></code> needs a check to assert that. This is also possible for sets.</p>
<div class="admonition-status admonition">
<p class="admonition-title">Status</p>
<p>Implemented, even works for non-constants. Needs other optimization
to become generally useful, and will itself help other optimization
to become possible. This allows us to e.g. only treat iteration over
tuples, and not care about sets.</p>
</div>
<p>In theory, something similar is also possible for <code class="docutils literal notranslate"><span class="pre">dict</span></code>. For the
later, it will be non-trivial though to maintain the order of execution
without temporary values introduced. The same thing is done for pure
constants of these types, they change to <code class="docutils literal notranslate"><span class="pre">tuple</span></code> values when iterated.</p>
</section>
</section>
<section id="updates-for-this-manual">
<h2>Updates for this Manual<a class="headerlink" href="#updates-for-this-manual" title="Permalink to this headline"></a></h2>
<p>This document is written in REST. That is an ASCII format which is
readable to human, but easily used to generate PDF or HTML documents.</p>
<p>You will find the current version at:
<a class="reference external" href="https://nuitka.net/doc/user-manual.html">https://nuitka.net/doc/user-manual.html</a></p>
<p>And the current PDF under: <a class="reference external" href="https://nuitka.net/doc/README.pdf">https://nuitka.net/doc/README.pdf</a></p>
</section>
</section>

<div class="section">
   
</div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Kay Hayen and Nuitka Contributors.</p>
  </div>

  
<div class='share-button-container'>
    <div class="socialbutton-wrapper">
        <a href="https://twitter.com/share?url=https://nuitka.net/doc/user-manual.html&hashtags=nuitka" target="_blank">
            <div class="socialbutton twitter" data-share-url="https://nuitka.net">
                <p class="icon">
                    <img src="/_static/icon-twitter.png">
                </p>

                <p class="shares">share...</p>
            </div>
        </a>

        <a href="https://www.facebook.com/sharer.php?u=https://nuitka.net/doc/user-manual.html&hashtag=%23nuitka"  target="_blank">
            <div class="socialbutton facebook" data-share-url="https://nuitka.net">
                <p class="icon">
                    <img src="/_static/icon-facebook.png">
                </p>

                <p class="shares">share...</p>
            </div>
        </a>

        <a href="http://www.reddit.com/submit?url=https://nuitka.net/doc/user-manual.html" target="_blank">
            <div class="socialbutton reddit">
                <p class="icon">
                    <img src="/_static/icon-reddit.png">
                </p>

                <p class="shares">share...</p>
            </div>
        </a>
    </div>
</div>



</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>